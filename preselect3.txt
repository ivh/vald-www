#acl ValdTeamGroup:read,write,delete
#format wiki
#language en
=== VALD Version 3.0 PRESELECT Version 3.4 ===

===== 1. Functionality =====

This program fulfills three functions: it (1) reads control parameters via standard input, (2) opens and reads and merges database file(s) and (3) filters the data and outputs it via standard output.

PRESELECT3 usage can be found out using special call: preselect3 -help

----
1.1. Standard input

Any text Standard input consists of several lines. Any text in any line following #-symbol is ignored and thus can be used as a comment. The input has the following layout:

||`<starting_wavelength>,<ending_wavelength>`|| wavelength range `<maximum_number_of_selected_lines>`|| 0 = no restriction                ||
||`<Ion or element or empty line>`                       ||species selection                                                                    || `<space>` - no restriction ||
||                                                                           ||                                                                                              || `Fe 1` - neutral iron           ||
||                                                                           ||                                                                                              || `Fe` - all iron ions              ||
||`<configuration_file>`                                       ||VALD3 configuration file                                                         ||E.g. `'VALD3_all.cfg'`           ||
||a b c d e f g h i j k l m                                             || Extraction flags                                                                      ||                                            ||

Flags control the out format and additional extraction filtering. Flag meaning:

a) 0 - "short" output format (energies in eV), 1 - "long" output. format (energies in eV), 2 - "model" output format, 3 - "short" format (energies in cm^-1^), 4 - "long" output format (energies in cm^-1^);

b) 1 - select only lines with known radiative damping constant, 0 - ignore this condition;

c) 1 - select only lines with known Stark damping constant, 0 - ignore this condition;

d) 1 - select only lines with known van der Waals damping constant, 0 - ignore this condition;

e) 1 - select only lines with known Lande factors, 0 - ignore this condition;

f) 1 - select only lines with known term designation, 0 - ignore this condition;

g) 1 - output extended van der Waals damping constants if available, 0 - convert extended van der Waals damping to a standard C6 constant;

h) 1 - output detailed Zeeman pattern if available 0 - do not output detailed Zeeman pattern (not yet implemented);

i) 1 - output extended Stark constants if available 0 - do not output extended Stark constants (not yet implemented);

j) 1 - output all wavelengths in vacuum, 0 - convert wavelengths longward of 200nm to air;

k) 0 - central wavelength is put out in Angstr&ouml;ms, 1 - central wavelength is converted to nanometers, 2 - central wavelength is converted to inverse centimeters and is in vacuum. This option overwrites option j;

l) 1 - scale the oscillator strength by isotopic abundance or not (0);

m) 0 - no Hyperfine Structure (HFS) splitting, 1 - apply the HFS splitting and re-sort the output in wavelength. 

The default value for all the flags is 0 except for l where the default is 1.

----
1.2. VALD3 file access and unkompress3

PRESELECT uses a set of subroutines written in C to access the VALD data files. The entry points used by PRESELECT are: UKOPEN (opening data files), UKREAD (positioning and reading the first data block), UKNEXT (reading the next data block) and UKCLOSE (closing data files). Version 3 of decompression routines includes two new features compared to the previous versions. The first is the ability of unkompress3 to determine byte order of the computer in the run-time. This removes the need to edit a makefile when porting VALD to a new platform. The second is obviously the compliance with the new record format used in VALD3.

----
1.3. Output structure and formats

The output of PRESELECT is sent to standard output and consists of 3 parts. The first line contains the name of the VALD configuration file (without quotes). The second line is an interpretation of the flags used for extraction using 2-symbol tags. The format and the possible values are as follows:

1 2 3 4 5 6 7 8 9<- tag number

'''`Sf------eVAiAA-----`''' <- default value corresponding to all flags set to zero

'''`LfEwZpEscmVacmISHFS`''' <- alternative example corresponding to flag set 4 0 0 0 0 0 1 1 1 1 2 1 1

Explanations:

1st tag: Sf/Mf/Lf - output is in short/model/long format

2nd tag: --/Ew - output contains extended van der Waals constants

3rd tag: --/Zp - output contains detailed Zeeman pattern

4rd tag: --/Es - output contains extended Stark constants

5th tag: eV/cm - output contains energies in eV/cm^-1

6th tag: Ai/Va - for lines redward of 200nm output contains
              wavelengths in air/vacuum

7th tag: AA/nm/cm - units of the central wavelength (Angstr&ouml;ms, nm or cm^-1)

8th tag: IS/-- - apply solar system isotopic ratio scaling to the oscillator strength

9th tag: ---/HFS - add post-processing to perform HFS splitting and re-sorting data stream in wavelength or frequency.

Here are some examples output generated by PRESELECT3 for different flag sets illustrating all possible output formats excluding the "model" format:
~-
{{{
 0 0 0 0 0 0 0 0 0 0 0 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        2
012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
Sf------eVAiAA
  6181.71522816  6180.00506524   278  -4.028     10.754     12.760  1.07  9.300 -5.850  -7.619  57 123  57  57  57  57  57 249  57                                                                                
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486  6180.07765247   278  -3.046     10.843     12.848  1.50  8.830 -5.690  -7.413  57 123  57  57  57  57  57 249  57                                                                                
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 0 0 0 0 0 0 0 0 0 0 1 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        2
012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
Sf------eVAinm
  6181.71522816   618.00050652   278  -4.028     10.754     12.760  1.07  9.300 -5.850  -7.619  57 123  57  57  57  57  57 249  57                                                                                
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486   618.00776525   278  -3.046     10.843     12.848  1.50  8.830 -5.690  -7.413  57 123  57  57  57  57  57 249  57                                                                                
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 0 0 0 0 0 0 1 0 0 0 0 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        2
012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
SfEw----eVAiAA
  6181.71522816  6180.00506524   278  -4.028     10.754     12.760  1.07  9.300 -5.850 327.241  57 123  57  57  57  57  57 249  57                                                                                
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486  6180.07765247   278  -3.046     10.843     12.848  1.50  8.830 -5.690 524.232  57 123  57  57  57  57  57 249  57                                                                                
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 0 0 0 0 0 0 1 0 0 0 1 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        2
012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
SfEw----eVAinm
  6181.71522816   618.00050652   278  -4.028     10.754     12.760  1.07  9.300 -5.850 327.241  57 123  57  57  57  57  57 249  57                                                                                
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486   618.00776525   278  -3.046     10.843     12.848  1.50  8.830 -5.690 524.232  57 123  57  57  57  57  57 249  57                                                                                
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 1 0 0 0 0 0 0 0 0 0 0 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21        22        23        24        25        26        27        28        29        30        31        32        33        34        35        36   
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
Lf------eVAiAA
  6181.71522816  6180.00506524   278  -4.028     10.754   3.5     12.760   3.5  1.15  0.99  1.07  9.300 -5.850  -7.619LS                                                                            (5D)4d e6GLS                                                                           4Fsp1P s4G*K10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486  6180.07765247   278  -3.046     10.843   5.5     12.848   4.5  1.27  1.17  1.50  8.830 -5.690  -7.413LS                                                                           4Fsp3P u4G*LS                                                                            (3G)5s f4GK10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 1 0 0 0 0 0 0 0 0 0 1 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21        22        23        24        25        26        27        28        29        30        31        32        33        34        35        36   
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
Lf------eVAinm
  6181.71522816   618.00050652   278  -4.028     10.754   3.5     12.760   3.5  1.15  0.99  1.07  9.300 -5.850  -7.619LS                                                                            (5D)4d e6GLS                                                                           4Fsp1P s4G*K10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486   618.00776525   278  -3.046     10.843   5.5     12.848   4.5  1.27  1.17  1.50  8.830 -5.690  -7.413LS                                                                           4Fsp3P u4G*LS                                                                            (3G)5s f4GK10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 1 0 0 0 0 0 1 0 0 0 0 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21        22        23        24        25        26        27        28        29        30        31        32        33        34        35        36   
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
LfEw----eVAiAA
  6181.71522816  6180.00506524   278  -4.028     10.754   3.5     12.760   3.5  1.15  0.99  1.07  9.300 -5.850 327.241LS                                                                            (5D)4d e6GLS                                                                           4Fsp1P s4G*K10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486  6180.07765247   278  -3.046     10.843   5.5     12.848   4.5  1.27  1.17  1.50  8.830 -5.690 524.232LS                                                                           4Fsp3P u4G*LS                                                                            (3G)5s f4GK10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 1 0 0 0 0 0 1 0 0 0 1 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21        22        23        24        25        26        27        28        29        30        31        32        33        34        35        36   
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
LfEw----eVAinm
  6181.71522816   618.00050652   278  -4.028     10.754   3.5     12.760   3.5  1.15  0.99  1.07  9.300 -5.850 327.241LS                                                                            (5D)4d e6GLS                                                                           4Fsp1P s4G*K10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486   618.00776525   278  -3.046     10.843   5.5     12.848   4.5  1.27  1.17  1.50  8.830 -5.690 524.232LS                                                                           4Fsp3P u4G*LS                                                                            (3G)5s f4GK10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 3 0 0 0 0 0 0 0 0 0 0 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13     
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
Sf------cmAiAA
  6181.71522816  6180.00506524   278  -4.028    86738.2700   102915.0100  1.07  9.300 -5.850  -7.619  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486  6180.07765247   278  -3.046    87450.4700   103627.0200  1.50  8.830 -5.690  -7.413  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 3 0 0 0 0 0 0 0 0 0 1 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13     
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
Sf------cmAinm
  6181.71522816   618.00050652   278  -4.028    86738.2700   102915.0100  1.07  9.300 -5.850  -7.619  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486   618.00776525   278  -3.046    87450.4700   103627.0200  1.50  8.830 -5.690  -7.413  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 3 0 0 0 0 0 1 0 0 0 0 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13     
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
SfEw----cmAiAA
  6181.71522816  6180.00506524   278  -4.028    86738.2700   102915.0100  1.07  9.300 -5.850 327.241  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486  6180.07765247   278  -3.046    87450.4700   103627.0200  1.50  8.830 -5.690 524.232  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 3 0 0 0 0 0 1 0 0 0 1 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13     
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
SfEw----cmAinm
  6181.71522816   618.00050652   278  -4.028    86738.2700   102915.0100  1.07  9.300 -5.850 327.241  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486   618.00776525   278  -3.046    87450.4700   103627.0200  1.50  8.830 -5.690 524.232  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 4 0 0 0 0 0 0 0 0 0 0 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21        22        23        24        25        26        27        28        29        30        31        32        33        34        35        36        3
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
Lf------cmAiAA
  6181.71522816  6180.00506524   278  -4.028    86738.2700   3.5   102915.0100   3.5  1.15  0.99  1.07  9.300 -5.850  -7.619LS                                                                            (5D)4d e6GLS                                                                           4Fsp1P s4G*K10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486  6180.07765247   278  -3.046    87450.4700   5.5   103627.0200   4.5  1.27  1.17  1.50  8.830 -5.690  -7.413LS                                                                           4Fsp3P u4G*LS                                                                            (3G)5s f4GK10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 4 0 0 0 0 0 0 0 0 0 1 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21        22        23        24        25        26        27        28        29        30        31        32        33        34        35        36        3
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
Lf------cmAinm
  6181.71522816   618.00050652   278  -4.028    86738.2700   3.5   102915.0100   3.5  1.15  0.99  1.07  9.300 -5.850  -7.619LS                                                                            (5D)4d e6GLS                                                                           4Fsp1P s4G*K10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486   618.00776525   278  -3.046    87450.4700   5.5   103627.0200   4.5  1.27  1.17  1.50  8.830 -5.690  -7.413LS                                                                           4Fsp3P u4G*LS                                                                            (3G)5s f4GK10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 4 0 0 0 0 0 1 0 0 0 0 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21        22        23        24        25        26        27        28        29        30        31        32        33        34        35        36        3
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
LfEw----cmAiAA
  6181.71522816  6180.00506524   278  -4.028    86738.2700   3.5   102915.0100   3.5  1.15  0.99  1.07  9.300 -5.850 327.241LS                                                                            (5D)4d e6GLS                                                                           4Fsp1P s4G*K10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486  6180.07765247   278  -3.046    87450.4700   5.5   103627.0200   4.5  1.27  1.17  1.50  8.830 -5.690 524.232LS                                                                           4Fsp3P u4G*LS                                                                            (3G)5s f4GK10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    

 4 0 0 0 0 0 1 0 0 0 1 -------------------------------------------------------------------
0         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21        22        23        24        25        26        27        28        29        30        31        32        33        34        35        36        3
0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
/home/vald/VALD3/VALD3/CONFIG/VALD3_obs.cfg                                     
LfEw----cmAinm
  6181.71522816   618.00050652   278  -4.028    86738.2700   3.5   102915.0100   3.5  1.15  0.99  1.07  9.300 -5.850 327.241LS                                                                            (5D)4d e6GLS                                                                           4Fsp1P s4G*K10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
  6181.78783486   618.00776525   278  -3.046    87450.4700   5.5   103627.0200   4.5  1.27  1.17  1.50  8.830 -5.690 524.232LS                                                                           4Fsp3P u4G*LS                                                                            (3G)5s f4GK10               Kurucz CrII 2010  57 123  57  57  57  57  57 249  57
 K10     RU      K10     K10     K10     K10     K10     BA-J    K10    
}}}
-~

----
===== 2. Limitations =====

PRESELECT has a number of configurable options set at compilation. These point to the VALD list of species and restrict maximum sizes of internal arrays.

2.1. Include files

An include file "VALD_home_path" set a global character variable VALDHM the absolute path to the VALD home directory on a given installation (no slash terminator). An include file "VALD_species" assigns the relative path and file name of the VALD list of species to the global character variable VALD_SPECIES and the number of entries in the list of species is assigned to the global integer variable VALD_sp_list_size. Normally those two include files should be generated during make (see the Makefile in PRESELECT directory).

----
2.2. Built-in restrictions

The maximum number of simultaneously open files is specified as a global integer parameter NF. This parameter is explicitly set inside PRESELECT (which is bad) and should instead be set at make according to the corresponding parameter of the operating system. Setting NF larger than the limit of the OS may result in run-time fatal error.
